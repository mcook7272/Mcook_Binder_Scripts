SELECT coh.person_id
	,m.measurement_concept_id
	,con.concept_name
	,coh.visit_start_date
	,coh.visit_end_date
	,m.measurement_datetime
	,DATEDIFF(day, coh.visit_start_date, m.measurement_datetime) "Start_Diff"
	,DATEDIFF(day, coh.visit_end_date, m.measurement_datetime) "End_Diff"
INTO results.CURE_ID_Measurements
FROM measurement m
INNER JOIN results.CURE_ID_Cohort coh
	ON m.visit_occurrence_id = coh.visit_occurrence_id
Join concept con
	on con.concept_id = m.measurement_concept_id
WHERE measurement_concept_id IN (
		'3028615'
		,'3004327'
		,'3003215'
		,'3028022'
		,'3033575'
		,'3013650'
		,'3034107'
		,'3000905'
		,'3022227'
		,'3035583'
		,'3046900'
		,'3022547'
		,'3028676'
		,'3029315'
		,'3023599'
		,'3006923'
		,'3024474'
		,'3024561'
		,'3028286'
		,'3037539'
		,'3035995'
		,'3045716'
		,'3013721'
		,'3022893'
		,'3008152'
		,'3015632'
		,'3024128'
		,'3013682'
		,'3006866'
		,'3014576'
		,'3018572'
		,'3035285'
		,'3007220'
		,'3020460'
		,'3016723'
		,'3017250'
		,'3017395'
		,'3023361'
		,'3051714'
		,'3052716'
		,'3053283'
		,'3049187'
		,'46236952'
		,''
		,'3013707'
		,'3001122'
		,'3015242'
		,'3016407'
		,'3026238'
		,'3004501'
		,'3009261'
		,'3013826'
		,'3020399'
		,'3020650'
		,'3037110'
		,'3009542'
		,'3023314'
		,'3000963'
		,'3004410'
		,'3003309'
		,'3022217'
		,'3042605'
		,'3032080'
		,'3023091'
		,'37208795'
		,'3014111'
		,'3047181'
		,'3020138'
		,'3005225'
		,'3022250'
		,'3011367'
		,'40759994'
		,'3024929'
		,'3027801'
		,'3005456'
		,'3023103'
		,'3041354'
		,'3046279'
		,'3020630'
		,'3019897'
		,'3019550'
		,'3019551'
		,'3022192'
		,'3019800'
		,'3021337'
		,'3032971'
		,'3009201'
		,'3019762'
		,'3027219'
		,'3004295'
		,'3025315'
		,'3038553'
		,'3024171'
		,'3004249'
		,'3012888'
		,'3027598'
		,'40762499'
		,'4353936'
		,'3016502'
		,'3027018'
		,'586516'
		,'3036277'
		,'3000963'
		,'3010813'
		,'3018198'
		,'3017732'
		,'3009542'
		,'3007461'
		,'3013115'
		,'3001604'
		,'3006315'
		,'3002385'
		,'3018677'
		,'3034426'
		,'3022217'
		,'3006923'
		,'3045524'
		,'3013721'
		,'3004501'
		,'3004295'
		,'3047181'
		,'3016723'
		,'3000285'
		,'3005456'
		,'3046279'
		,'3020460'
		,'3016436'
		,'3021337'
		,'3051714'
		,'3001122'
		,'3023091'
		,'3016407'
		,'40771922'
		,'3007220'
		,'3005629'
		,'3020891'
		,'703443'
		,'36033639'
		)
	AND (
		DATEDIFF(day, coh.visit_start_date, m.measurement_datetime) > - 3
		AND DATEDIFF(day, coh.visit_end_date, m.measurement_datetime) < 2
		)
order by coh.person_id, m.measurement_datetime

		SELECT measurement_concept_id, count(*)
FROM measurement m
INNER JOIN results.N3C_Cohort_Updated_FDA coh
	ON m.visit_occurrence_id = coh.visit_occurrence_id
WHERE measurement_concept_id IN (
		'3028615'
		,'3004327'
		,'3003215'
		,'3028022'
		,'3033575'
		,'3013650'
		,'3034107'
		,'3000905'
		,'3022227'
		,'3035583'
		,'3046900'
		,'3022547'
		,'3028676'
		,'3029315'
		,'3023599'
		,'3006923'
		,'3024474'
		,'3024561'
		,'3028286'
		,'3037539'
		,'3035995'
		,'3045716'
		,'3013721'
		,'3022893'
		,'3008152'
		,'3015632'
		,'3024128'
		,'3013682'
		,'3006866'
		,'3014576'
		,'3018572'
		,'3035285'
		,'3007220'
		,'3020460'
		,'3016723'
		,'3017250'
		,'3017395'
		,'3023361'
		,'3051714'
		,'3052716'
		,'3053283'
		,'3049187'
		,'46236952'
		,''
		,'3013707'
		,'3001122'
		,'3015242'
		,'3016407'
		,'3026238'
		,'3004501'
		,'3009261'
		,'3013826'
		,'3020399'
		,'3020650'
		,'3037110'
		,'3009542'
		,'3023314'
		,'3000963'
		,'3004410'
		,'3003309'
		,'3022217'
		,'3042605'
		,'3032080'
		,'3023091'
		,'37208795'
		,'3014111'
		,'3047181'
		,'3020138'
		,'3005225'
		,'3022250'
		,'3011367'
		,'40759994'
		,'3024929'
		,'3027801'
		,'3005456'
		,'3023103'
		,'3041354'
		,'3046279'
		,'3020630'
		,'3019897'
		,'3019550'
		,'3019551'
		,'3022192'
		,'3019800'
		,'3021337'
		,'3032971'
		,'3009201'
		,'3019762'
		,'3027219'
		,'3004295'
		,'3025315'
		,'3038553'
		,'3024171'
		,'3004249'
		,'3012888'
		,'3027598'
		,'40762499'
		,'4353936'
		,'3016502'
		,'3027018'
		,'586516'
		,'3036277'
		,'3000963'
		,'3010813'
		,'3018198'
		,'3017732'
		,'3009542'
		,'3007461'
		,'3013115'
		,'3001604'
		,'3006315'
		,'3002385'
		,'3018677'
		,'3034426'
		,'3022217'
		,'3006923'
		,'3045524'
		,'3013721'
		,'3004501'
		,'3004295'
		,'3047181'
		,'3016723'
		,'3000285'
		,'3005456'
		,'3046279'
		,'3020460'
		,'3016436'
		,'3021337'
		,'3051714'
		,'3001122'
		,'3023091'
		,'3016407'
		,'40771922'
		,'3007220'
		,'3005629'
		,'3020891'
		,'703443'
		,'36033639'
		)
	AND (
		DATEDIFF(day, coh.visit_start_date, m.measurement_datetime) > - 3
		AND DATEDIFF(day, coh.visit_end_date, m.measurement_datetime) < 2
		)
group by measurement_concept_id
order by count(*) desc